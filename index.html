<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Sheets</title>
    <script type="module">

        let date = new Date();
        date = date.toLocaleString("en-CA", {
            timeZone: "America/Vancouver",
            timeZoneName: "long",
        });
        const eventList = [{"appName": "Sheets", "date": date}];

    window.addEventListener("click", (event) => {
        let x = event.pageX;  // Horizontal
        let y = event.pageY;  // Vertical
        let time = event.timeStamp
        eventList.push({"x": x, "y": y, "timeStamp": time})
        console.log(x,y, time);
        console.log(event.target);
        console.log(eventList);
        
    });

    document.addEventListener("visibilitychange", ()=>{
        if (document.hidden) {
            const apiKey = import.meta.env.VITE_APP_SECRET;
            fetch(apiKey,{
                method: "post",
                headers: {
                    "Content-type": "application/json"
                },
                body: JSON.stringify({ eventList }),
                keepalive: true
            })

            localStorage.clear();

        }
    })
    </script>
  </head>
  <body>
    <div id="app"></div>
    <script type="module" src="/src/main.ts"></script>
  </body>
</html>
